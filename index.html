<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Voltify</title>
  <link rel="icon" type="image/png" href="logo.png" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg0:#070A12;
      --bg1:#0B1020;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.10);
      --text:#EAF0FF;
      --muted: rgba(234,240,255,.62);
      --accent:#7C3AED;
      --accent2:#22C55E;
      --ring: rgba(124,58,237,.35);
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --radius: 18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:"Space Grotesk", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 20% 10%, color-mix(in oklab, var(--accent) 18%, transparent), transparent 60%),
        radial-gradient(900px 500px at 85% 20%, color-mix(in oklab, var(--accent2) 14%, transparent), transparent 55%),
        radial-gradient(900px 700px at 50% 80%, rgba(255,255,255,.06), transparent 60%),
        linear-gradient(180deg, var(--bg0) 0%, var(--bg1) 100%);
      overflow-x:hidden;
    }

    .energy{
      position:fixed;
      inset:-2px;
      pointer-events:none;
      opacity:.55;
      background:
        repeating-linear-gradient(90deg, rgba(255,255,255,.04) 0 1px, transparent 1px 60px),
        repeating-linear-gradient(0deg, rgba(255,255,255,.02) 0 1px, transparent 1px 60px);
      mask-image: radial-gradient(circle at 50% 35%, black 0%, transparent 68%);
      animation: drift 10s linear infinite;
    }
    @keyframes drift{
      from{transform:translate3d(0,0,0)}
      to{transform:translate3d(-60px, -60px, 0)}
    }

    header{
      position:sticky;
      top:0;
      z-index:50;
      backdrop-filter: blur(12px);
      background: linear-gradient(180deg, rgba(10,12,20,.82), rgba(10,12,20,.45));
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .topbar{
      max-width:1100px;
      margin:0 auto;
      padding:12px 16px;
      display:flex;
      align-items:center;
      gap:12px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:700;
      letter-spacing:.4px;
    }
    .bolt{
      width:34px;height:34px;border-radius:12px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.35), transparent 55%),
                  linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 0 0 1px rgba(255,255,255,.18), 0 18px 50px rgba(0,0,0,.45);
      display:grid;
      place-items:center;
      font-size:18px;
    }
    nav{
      margin-left:auto;
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .navbtn{
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color:var(--text);
      padding:9px 12px;
      border-radius:14px;
      text-decoration:none;
      font-weight:600;
      font-size:14px;
      transition:.15s ease;
      cursor: pointer;
    }
    .navbtn:hover{
      transform: translateY(-1px);
      border-color: color-mix(in oklab, var(--accent) 40%, rgba(255,255,255,.12));
      box-shadow: 0 0 0 3px var(--ring);
    }

    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding:28px 16px 40px;
    }

    .hero{
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap:16px;
      align-items:stretch;
      margin-top:16px;
    }
    @media (max-width: 900px){
      .hero{grid-template-columns:1fr}
    }

    .card{
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute;
      inset:-2px;
      background: radial-gradient(800px 240px at 20% 0%, color-mix(in oklab, var(--accent) 22%, transparent), transparent 60%),
                  radial-gradient(800px 240px at 80% 0%, color-mix(in oklab, var(--accent2) 18%, transparent), transparent 60%);
      opacity:.7;
      pointer-events:none;
    }
    .card > *{position:relative; z-index:1}

    .mainCard{
      padding:22px;
      min-height: 320px;
      display:flex;
      flex-direction:column;
      gap:14px;
    }
    .title{
      margin:0;
      font-size: clamp(34px, 4vw, 56px);
      line-height:1.05;
      letter-spacing:-.5px;
    }
    .subtitle{
      margin:0;
      color:var(--muted);
      font-size: 16px;
    }

    .searchMode {
      display: flex;
      gap: 10px;
      margin-bottom: 10px;
      background: rgba(0,0,0,.25);
      padding: 6px;
      border-radius: 40px;
      width: fit-content;
      border: 1px solid rgba(255,255,255,.1);
    }
    .modeBtn {
      padding: 8px 16px;
      border-radius: 30px;
      border: none;
      background: transparent;
      color: var(--muted);
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all .15s ease;
    }
    .modeBtn.active {
      background: var(--accent);
      color: white;
      box-shadow: 0 4px 12px rgba(124,58,237,.3);
    }

    .searchRow{
      margin-top:8px;
      display:flex;
      gap:10px;
      align-items:center;
    }
    .searchRow input{
      flex:1;
      padding: 14px 14px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      outline:none;
      background: rgba(0,0,0,.18);
      color: var(--text);
      font-size: 15px;
    }
    .searchRow input:focus{
      border-color: color-mix(in oklab, var(--accent) 55%, rgba(255,255,255,.14));
      box-shadow: 0 0 0 4px var(--ring);
    }
    .go{
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: linear-gradient(135deg, color-mix(in oklab, var(--accent) 80%, #000), color-mix(in oklab, var(--accent2) 70%, #000));
      color: white;
      font-weight:700;
      cursor:pointer;
    }

    .quickGrid{
      margin-top:auto;
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:10px;
    }
    .tile{
      padding:14px;
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      border:1px solid rgba(255,255,255,.12);
      text-decoration:none;
      color:var(--text);
      transition:.15s ease;
      text-align: center;
    }
    .tile:hover{
      transform: translateY(-2px);
      border-color: color-mix(in oklab, var(--accent) 40%, rgba(255,255,255,.12));
      box-shadow: 0 0 0 4px var(--ring);
    }
    .tile b{display:block;font-size:16px}
    .tile small{color:var(--muted)}

    .sideCard{
      padding:18px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    .badgeRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .badge{
      padding:10px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      color: var(--muted);
      font-size: 13px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    .dot{
      width:8px;height:8px;border-radius:50%;
      background: var(--accent2);
      box-shadow: 0 0 18px color-mix(in oklab, var(--accent2) 50%, transparent);
    }

    .bigNum{
      font-size: 34px;
      font-weight:800;
      letter-spacing:-.5px;
      color: var(--text);
      margin-top:2px;
    }

    /* Settings Modal */
    .modalBack{
      position:fixed; inset:0;
      background: rgba(0,0,0,.85);
      backdrop-filter: blur(8px);
      display:none;
      place-items:center;
      padding:16px;
      z-index:99;
    }
    .modal{
      width: min(900px, 96vw);
      max-height: 90vh;
      overflow-y: auto;
      border-radius: 30px;
      background: rgba(10,12,20,.95);
      border:1px solid rgba(255,255,255,.14);
      box-shadow: var(--shadow);
    }
    .modalHead{
      padding:20px 24px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.3);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .modalHead b{
      font-size: 20px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .close{
      cursor:pointer;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 10px 20px;
      border-radius: 30px;
      font-weight:600;
      transition:.15s;
    }
    .close:hover{
      background: rgba(255,99,99,.3);
      border-color: #FF6B6B;
    }

    .modalBody{
      padding:30px;
      display: flex;
      flex-direction: column;
      gap: 30px;
    }

    /* Theme Section */
    .settings-section{
      border:1px solid rgba(255,255,255,.12);
      border-radius: 18px;
      background: rgba(255,255,255,.05);
      padding:20px;
    }
    .settings-section h3{
      margin:0 0 15px 0;
      font-size:18px;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .row{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-bottom: 20px;
    }
    .preset{
      cursor:pointer;
      padding:10px 16px;
      border-radius: 30px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      color: var(--text);
      font-weight:600;
      font-size:14px;
      transition:.15s;
    }
    .preset:hover{
      box-shadow:0 0 0 4px var(--ring);
      border-color: var(--accent);
    }
    .picker{
      display:flex;
      align-items:center;
      gap:15px;
      margin-top:10px;
      flex-wrap: wrap;
    }
    .picker label{
      color: var(--muted);
      font-size:14px;
    }
    input[type="color"]{
      width:50px;
      height:40px;
      border:1px solid rgba(255,255,255,.2);
      border-radius:10px;
      background:transparent;
      padding:0;
      cursor:pointer;
    }

    /* Tab Cloaker Section */
    .cloaker-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 12px;
      margin: 15px 0;
    }
    .cloak-option {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 12px;
      padding: 15px 10px;
      text-align: center;
      cursor: pointer;
      transition: all 0.15s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }
    .cloak-option:hover {
      border-color: var(--accent2);
      transform: translateY(-2px);
      background: rgba(34,197,94,0.1);
    }
    .cloak-option.active {
      border-color: var(--accent2);
      background: rgba(34,197,94,0.15);
      box-shadow: 0 0 0 2px rgba(34,197,94,0.3);
    }
    .cloak-option img {
      width: 32px;
      height: 32px;
      border-radius: 8px;
    }
    .cloak-option span {
      font-size: 13px;
      font-weight: 600;
    }
    .custom-cloak {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    .custom-cloak input {
      flex: 1;
      min-width: 200px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.3);
      color: white;
    }
    .custom-cloak button {
      padding: 12px 24px;
      border-radius: 12px;
      border: none;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      color: white;
      font-weight: 600;
      cursor: pointer;
    }
    .smallNote{
      color: var(--muted);
      font-size: 12px;
      margin-top: 10px;
      line-height:1.4
    }
  </style>
</head>
<body>
  <div class="energy"></div>

  <header>
    <div class="topbar">
      <div class="brand">
        <img src="logo.png" alt="Voltify Logo" style="width:34px;height:34px;border-radius:12px;">
        <div>Voltify</div>
      </div>
      <nav>
        <a class="navbtn" href="index.html">Home</a>
        <a class="navbtn" href="games.html">Games</a>
        <a class="navbtn" href="movies.html">Movies</a>
        <a class="navbtn" id="openSettings">Settings</a>
      </nav>
    </div>
  </header>

  <div class="wrap">
    <section class="hero">
      <div class="card">
        <div class="mainCard">
          <h1 class="title">Voltify‚ö°</h1>
          <p class="subtitle">Games, Movies, And Tools Made For You.</p>

          <div class="searchMode">
            <button class="modeBtn active" id="normalMode">üîç Study Mode</button>
            <button class="modeBtn" id="proxyMode">üåê Research Mode</button>
          </div>

          <div class="searchRow">
            <input id="searchInput" placeholder="Search Google or type a URL..." autocomplete="off" />
            <button class="go" id="goBtn">Go</button>
          </div>

          <div class="quickGrid">
            <a class="tile" href="games.html">
              <b>üéÆ Games</b>
              <small>Coming soon</small>
            </a>
            <a class="tile" href="movies.html">
              <b>üé¨ Movies</b>
              <small>Coming soon</small>
            </a>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="sideCard">
          <div class="badgeRow">
            <div class="badge"><span class="dot"></span><span id="timeText">--:--</span></div>
            <div class="badge">Visitors: <b id="visitorCount">--</b></div>
          </div>
          <div style="margin-top:6px;color:var(--muted);font-weight:600;">Status</div>
          <div class="bigNum" id="statusText">Active!</div>
          <div class="smallNote">
            Tip: Use Settings to cloak your tab
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Settings Modal -->
  <div class="modalBack" id="modalBack">
    <div class="modal">
      <div class="modalHead">
        <b>‚öôÔ∏è Voltify Settings</b>
        <button class="close" id="closeSettings">Close</button>
      </div>
      <div class="modalBody">
        <!-- Theme Section (Left Side) -->
        <div class="settings-section">
          <h3>üé® Theme Presets</h3>
          <div class="row">
            <button class="preset" data-theme="neon">Neon</button>
            <button class="preset" data-theme="ocean">Ocean</button>
            <button class="preset" data-theme="ember">Ember</button>
            <button class="preset" data-theme="mono">Mono</button>
          </div>

          <div class="picker">
            <label>Accent</label>
            <input type="color" id="accentPicker" />
            <label>Accent 2</label>
            <input type="color" id="accent2Picker" />
          </div>
          <div class="smallNote">
            Presets change instantly. Color pickers fine-tune the 2 main colors.
          </div>
        </div>

        <!-- Tab Cloaker Section (Right Side / Below) -->
        <div class="settings-section">
          <h3>üïµÔ∏è Tab Cloaker</h3>
          <div class="cloaker-grid">
            <div class="cloak-option" data-title="Quizlet" data-icon="https://www.quizlet.com/favicon.ico">
              <img src="https://www.quizlet.com/favicon.ico" onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%234259FF%22/><text x=%2220%22 y=%2270%22 font-size=%2270%22 fill=%22white%22>Q</text></svg>'">
              <span>Quizlet</span>
            </div>
            <div class="cloak-option" data-title="Clever" data-icon="https://www.clever.com/favicon.ico">
              <img src="https://www.clever.com/favicon.ico" onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%23FF6B00%22/><text x=%2220%22 y=%2270%22 font-size=%2270%22 fill=%22white%22>C</text></svg>'">
              <span>Clever</span>
            </div>
            <div class="cloak-option" data-title="Lexia Power Up" data-icon="https://www.lexiapowerup.com/favicon.ico">
              <img src="https://www.lexiapowerup.com/favicon.ico" onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%230099CC%22/><text x=%2220%22 y=%2270%22 font-size=%2270%22 fill=%22white%22>L</text></svg>'">
              <span>Lexia</span>
            </div>
            <div class="cloak-option" data-title="i-Ready" data-icon="https://www.i-ready.com/favicon.ico">
              <img src="https://www.i-ready.com/favicon.ico" onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%23ED1C24%22/><text x=%2220%22 y=%2270%22 font-size=%2270%22 fill=%22white%22>i</text></svg>'">
              <span>i-Ready</span>
            </div>
            <div class="cloak-option" data-title="Canvas" data-icon="https://www.canvas.com/favicon.ico">
              <img src="https://www.instructure.com/favicon.ico" onerror="this.src='data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%23E72429%22/><text x=%2220%22 y=%2270%22 font-size=%2270%22 fill=%22white%22>C</text></svg>'">
              <span>Canvas</span>
            </div>
          </div>

          <div class="custom-cloak">
            <input type="text" id="customTitle" placeholder="Custom title (e.g., 'My Homework')" />
            <button id="applyCustomCloak">Apply</button>
          </div>
          <div class="smallNote">
            Click any preset or enter a custom title to cloak this tab instantly.
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== TAB CLOAKER =====
    const cloakOptions = document.querySelectorAll('.cloak-option');
    let currentCloak = null;

    // Function to apply cloak
    function applyCloak(title, iconUrl) {
      // Change page title
      document.title = title;
      
      // Change favicon
      let link = document.querySelector("link[rel*='icon']") || document.createElement('link');
      link.type = 'image/x-icon';
      link.rel = 'shortcut icon';
      link.href = iconUrl;
      document.getElementsByTagName('head')[0].appendChild(link);
      
      // Save to localStorage
      localStorage.setItem('voltify_cloak', JSON.stringify({ title, icon: iconUrl }));
      
      // Update active state
      cloakOptions.forEach(opt => opt.classList.remove('active'));
    }

    // Load saved cloak
    const savedCloak = localStorage.getItem('voltify_cloak');
    if (savedCloak) {
      const cloak = JSON.parse(savedCloak);
      applyCloak(cloak.title, cloak.icon);
    }

    // Add click handlers to cloak options
    cloakOptions.forEach(option => {
      option.addEventListener('click', () => {
        const title = option.dataset.title;
        const icon = option.dataset.icon;
        applyCloak(title, icon);
        option.classList.add('active');
      });
    });

    // Custom cloak
    document.getElementById('applyCustomCloak').addEventListener('click', () => {
      const customTitle = document.getElementById('customTitle').value.trim();
      if (customTitle) {
        applyCloak(customTitle, 'logo.png'); // Use Voltify logo as fallback
      }
    });

    // ===== THEME SYSTEM =====
    const themes = {
      neon:  { accent:'#7C3AED', accent2:'#22C55E', bg0:'#070A12', bg1:'#0B1020' },
      ocean: { accent:'#06B6D4', accent2:'#3B82F6', bg0:'#041018', bg1:'#061A2B' },
      ember: { accent:'#F97316', accent2:'#EF4444', bg0:'#120707', bg1:'#1D0B0B' },
      mono:  { accent:'#A3A3A3', accent2:'#E5E7EB', bg0:'#070707', bg1:'#111111' },
    };

    function applyTheme(t){
      const r = document.documentElement;
      r.style.setProperty('--accent', t.accent);
      r.style.setProperty('--accent2', t.accent2);
      r.style.setProperty('--bg0', t.bg0);
      r.style.setProperty('--bg1', t.bg1);
      r.style.setProperty('--ring', `rgba(${hexToRgb(t.accent).join(',')}, .35)`);
    }

    function hexToRgb(hex){
      const h = hex.replace('#','').trim();
      const full = h.length === 3 ? h.split('').map(c=>c+c).join('') : h;
      const n = parseInt(full, 16);
      return [(n>>16)&255, (n>>8)&255, n&255];
    }

    function saveThemeState(state){
      localStorage.setItem('voltify_theme', JSON.stringify(state));
    }
    function loadThemeState(){
      try{
        return JSON.parse(localStorage.getItem('voltify_theme') || 'null');
      }catch{ return null; }
    }

    const savedTheme = loadThemeState();
    if (savedTheme?.preset && themes[savedTheme.preset]) {
      applyTheme(themes[savedTheme.preset]);
      if (savedTheme.customAccent) document.documentElement.style.setProperty('--accent', savedTheme.customAccent);
      if (savedTheme.customAccent2) document.documentElement.style.setProperty('--accent2', savedTheme.customAccent2);
    } else {
      applyTheme(themes.neon);
    }

    function currentVar(name){
      return getComputedStyle(document.documentElement).getPropertyValue(name).trim();
    }
    
    const accentPicker = document.getElementById('accentPicker');
    const accent2Picker = document.getElementById('accent2Picker');
    accentPicker.value = rgbToHex(currentVar('--accent'));
    accent2Picker.value = rgbToHex(currentVar('--accent2'));

    function rgbToHex(v){
      if (v.startsWith('#')) return v;
      const m = v.match(/(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/);
      if (!m) return '#7C3AED';
      const [r,g,b] = [Number(m[1]),Number(m[2]),Number(m[3])];
      return '#' + [r,g,b].map(x=>x.toString(16).padStart(2,'0')).join('');
    }

    document.querySelectorAll('.preset').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        const key = btn.dataset.theme;
        applyTheme(themes[key]);
        document.documentElement.style.setProperty('--ring', `rgba(${hexToRgb(themes[key].accent).join(',')}, .35)`);
        accentPicker.value = themes[key].accent;
        accent2Picker.value = themes[key].accent2;
        saveThemeState({ preset:key, customAccent:themes[key].accent, customAccent2:themes[key].accent2 });
      });
    });

    function applyCustomColors(){
      const a1 = accentPicker.value;
      const a2 = accent2Picker.value;
      document.documentElement.style.setProperty('--accent', a1);
      document.documentElement.style.setProperty('--accent2', a2);
      document.documentElement.style.setProperty('--ring', `rgba(${hexToRgb(a1).join(',')}, .35)`);
      const last = loadThemeState() || { preset:'custom' };
      saveThemeState({ ...last, preset:last.preset || 'custom', customAccent:a1, customAccent2:a2 });
    }
    accentPicker.addEventListener('input', applyCustomColors);
    accent2Picker.addEventListener('input', applyCustomColors);

    // ===== PROXY MODE =====
    let searchMode = 'normal';
    const normalBtn = document.getElementById('normalMode');
    const proxyBtn = document.getElementById('proxyMode');
    const searchInput = document.getElementById('searchInput');
    const goBtn = document.getElementById('goBtn');
    
    normalBtn.addEventListener('click', () => {
      searchMode = 'normal';
      normalBtn.classList.add('active');
      proxyBtn.classList.remove('active');
      searchInput.placeholder = 'Search Google or type a URL...';
    });
    
    proxyBtn.addEventListener('click', () => {
      searchMode = 'proxy';
      proxyBtn.classList.add('active');
      normalBtn.classList.remove('active');
      searchInput.placeholder = 'Enter site to access (e.g., example.com)';
    });
    
    async function runSearch() {
      const q = searchInput.value.trim();
      if (!q) return;
      
      if (searchMode === 'normal') {
        const looksLikeUrl = q.includes('.') && !q.includes(' ') && !q.startsWith('?');
        const url = looksLikeUrl
          ? (q.startsWith('http') ? q : 'https://' + q)
          : 'https://www.google.com/search?q=' + encodeURIComponent(q);
        window.open(url, '_blank');
      } else {
        let targetUrl = q;
        if (!targetUrl.startsWith('http')) {
          targetUrl = 'https://' + targetUrl;
        }
        
        // Proxy backends
        const proxies = [
          `https://corsproxy.io/?${encodeURIComponent(targetUrl)}`,
          `https://api.allorigins.win/raw?url=${encodeURIComponent(targetUrl)}`,
          `https://thingproxy.freeboard.io/fetch/${targetUrl}`
        ];
        
        let loaded = false;
        for (let proxy of proxies) {
          if (loaded) break;
          try {
            let response = await fetch(proxy, { signal: AbortSignal.timeout(8000) });
            let contentType = response.headers.get('content-type');
            if (response.ok && contentType && contentType.includes('text/html')) {
              let html = await response.text();
              let newWindow = window.open();
              newWindow.document.write(html);
              newWindow.document.close();
              loaded = true;
              break;
            }
          } catch (e) {
            console.log('Proxy failed:', proxy);
          }
        }
        
        if (!loaded) {
          alert('Unable to load site. Try another URL or use Study Mode.');
        }
      }
    }
    
    goBtn.addEventListener('click', runSearch);
    searchInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') runSearch();
    });

    // ===== TIME =====
    function updateTime(){
      const d = new Date();
      let h = d.getHours();
      const m = String(d.getMinutes()).padStart(2,'0');
      const ampm = h >= 12 ? 'PM' : 'AM';
      h = h % 12; if (h === 0) h = 12;
      document.getElementById('timeText').textContent = `${h}:${m} ${ampm}`;
    }
    updateTime();
    setInterval(updateTime, 1000);

    // ===== VISITOR COUNTER =====
    function localCount(){
      const k = 'voltify_local_visits';
      const v = Number(localStorage.getItem(k) || '0') + 1;
      localStorage.setItem(k, String(v));
      return v;
    }
    
    async function updateVisitorCount(){
      const el = document.getElementById('visitorCount');
      try{
        const url = `https://api.countapi.xyz/hit/voltify-${Math.random()}/home`;
        const r = await fetch(url, { cache:'no-store' });
        if (!r.ok) throw new Error();
        const data = await r.json();
        el.textContent = data.value.toLocaleString();
      } catch {
        el.textContent = localCount().toLocaleString();
      }
    }
    updateVisitorCount();

    // Settings modal
    const modalBack = document.getElementById('modalBack');
    document.getElementById('openSettings').addEventListener('click', (e) => {
      e.preventDefault();
      modalBack.style.display = 'grid';
    });
    
    document.getElementById('closeSettings').addEventListener('click', () => {
      modalBack.style.display = 'none';
    });
    
    modalBack.addEventListener('click', (e) => {
      if (e.target === modalBack) modalBack.style.display = 'none';
    });
  </script>
</body>
</html>